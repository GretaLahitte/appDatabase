<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <link href="https://fonts.googleapis.com/css?family=Poiret+One" rel="stylesheet">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        
        <link rel="stylesheet" href="styles.css">
        <title>GretaJS SQL tool</title>
        
    </head>
    <body data-context="myContext">

        <div data-role="presenters">
            <!-- Affichage de la zone graphiques  -->
            <div data-role="presenter" id="db_tables">
                <div class="main">  
                    <div class="table">{binding from:tables presenter:tables fallback:no_table}</div>
                </div>
            </div>
            <div data-role="presenter" id="no_table">
                <h3>Pas de tables a afficher</h3>
            </div>

            <!-- affichage des tables -->
            <div data-role="presenter" id="tables">
                <div data-binded-class="shadowed {binding from:selected converter:setTableSelectedConverter}" data-binded-style="{binding from:coords converter:coords_to_translate}">
                    <div class="header invert"
                    data-binded-mousedown="{binding command:start_drag command_params:$this}"
                    draggable><span>{binding from:name}</span>
                    <a data-binded-click="{binding command:show_menu command_params:$this}"><i class="material-icons rippler">menu</i></a></div>
                    <content>{binding from:fields presenter:field_presenter empty:no_field_fallback}</content>
                    <footer>

                    </footer>
                </div>
            </div>

            <!-- affichage des champs -->
            <div data-role="presenter" id="field_presenter">
                <div >
                    
                    <h3 data-binded-id="{binding from:id}"><a data-binded-click="{binding command:show_item_properties command_params:$this}">{binding from:name}</a></h3>
                    
                </div>
            </div>
             <div data-role="presenter" id="no_field_fallback">
                <div>
                    <h3>Rien a afficher</h3>
                </div>
            </div>


            <!-- affichage des relations entre les tables -->
            <div data-role="presenter" id="relations">
                <div class="main" >
                    <svg style="margin-top:28.8px" width="100%" height="100%">{binding from:relations presenter:relation_item_presenter}</div>
                </g>
            </div>
            <svg data-role="presenter" id="relation_item_presenter">
                <g class="relation">
                        <polyline stroke-linejoin="round" fill="none" stroke="#3E3E3E" stroke-width:"1" stroke-dasharray="5px 5px" data-binded-points="{binding from:id converter:relation_to_points_converter converter_params:$this forceAttr:true}"/>
                </g>
            </svg>

            <!-- Affichage des infos du header -->
            <div data-role="presenter" id="db_recap">
                
                    
                    <div class="recap">url:<strong>
                            <span>{binding from:db_type}</span>://
                            <span>{binding from:login}</span>:
                            <span>{binding from:passwrd}</span>@
                            <span>{binding from:host}</span>:
                            <span>{binding from:db_port}</span>/
                            <span>{binding from:db_name}</span>
                            </strong>
                    </div>
                
            </div>
            <div data-role="presenter" id="no_connection">
                <div>
                    Connection form a la base...
                </div>
            </div>


            <!-- affichage des menu -->
            <div data-role="presenter" id="menu_item_presenter">
                <div>
                    <div class="menu-item" data-binded-click="{binding command:menu_action command_params:$action}"><i class="material-icons">{binding from:icon}</i><span>{binding from:label}</span></div>
                </div>
            </div>


            <!-- affichage des boites de dialogues -->
            <div data-role="presenter" id="dialog_presenter">
                <div class="modal-content  shadowed">
                    <h2>{binding from:title}</h2>
                    <p>{binding from:desc}</p>
                    <content>{binding from:content presenter:dialog_content_presenter}</content>
                    <div class="commands">{binding from:commands presenter:dialog_command_presenter}</div>
                </div>
                

            </div>
            <div data-role="presenter" id="dialog_content_presenter">
                <div data-type="Table">
                    <div>
                        <label class="field-input">Table name:</label>
                        <input type="text" data-binded-value="{binding from:name mode:2way}">

                    </div>
                </div>
                <div data-type="Field">
                    <div>
                        <label class="field-input">Field name:</label>
                        <input type="text" data-binded-value="{binding from:name mode:2way}">

                    </div>
                </div>
                <div data-type="Base">
                    <h1>Type Base</h1>
                </div>
                <div data-type="Relation">
                    <h1>Type Relation</h1>
                </div>
                
                <div data-type="ExportSQLDlg">
                    Export SQL datas...
                </div>
                <div data-type="ConfirmDlg">
                    <h3>{binding from:question}</h3>
                </div>
            </div>


            <div data-role="presenter" id="dialog_command_presenter">
                <div>
                    <button data-binded-click="{binding command:dlg_action command_params:$action}" class="invert" type="button">{binding from:label}</button>
                </div>
            </div>
        </div>




        <!-- main de l'application -->
        <header class="invert">
            <h1>{binding from:app_name}</h1>
            <h2><a data-binded-click="{binding command:test_change_name}">change name</a></h2>
            
            <div>{binding from:db presenter:db_recap fallback:no_connection}</div>
            
        </header>
        <content data-binded-contextmenu="{binding command:showMainMenu}"
        data-binded-click="{binding command:showMainMenu}">
            
            
            <div>{binding from:db presenter:db_tables}</div>
            <div>{binding from:db presenter:relations}</div>
        </content>





        <div id="main_menu" data-binded-class="main-menu invert shadowed {binding from:menu converter:ftw2:is_true converter_params:['visible','invisible']}"
            data-binded-style="{binding from:menu_coords converter:coords_to_translate}">
                {binding from:menu presenter:menu_item_presenter deep:false}
        </div>

        <!-- The Modal -->
        <div id="myModal"
         class="modal  {binding from:show_dlg converter:ftw2:is_true converter_params:['visible','invisible']}">{binding from:show_dlg presenter:dialog_presenter}</div>

        </div>

        <footer>

        </footer>

    </body>
    
    <script src="./ftw2.js"></script>
    <script src="./core.1.js"></script>
        
</html>
